clear;clc;
% 数值分析
% 第二次作业
% Ch4-1 Gauss-Seidel迭代计算

D=[5,0,0;0,4,0;0,0,10];
L=[0,0,0;1,0,0;-2,3,0];
U=[0,-2,-1;0,0,-2;0,0,0];
b=[-12;20;3];

B=(D-L)\U   % 求迭代公式中的B
f=(D-L)\b   % 求迭代公式中的f

[v,lambda]=eig(B)
sqrt(0.1125^2+0.1654^2) % 谱半径

k=1;
x=zeros(3,2);
x(:,k+1)=B*x(:,1)+f;
disp("------------iter:1--------------")
double(x)
while norm(x(:,k+1)-x(:,k),"inf")>=0.02
    k=k+1;
    x(:,k+1)=B*x(:,k)+f;
    disp("------------iter: "+k+"--------------")
    double(x)
end